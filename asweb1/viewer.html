<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Dergi Viewer</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.14.305/pdf.min.js"></script>

<style>
body{
    margin:0;
    background:#0f0f0f;
    font-family:Arial;
    color:white;
    overflow:hidden;
}

.topbar{
    position:fixed;
    top:15px;
    left:20px;
    right:20px;
    display:flex;
    justify-content:space-between;
    align-items:center;
    z-index:100;
}

.btn{
    background:white;
    color:black;
    padding:8px 14px;
    border-radius:20px;
    font-weight:bold;
    cursor:pointer;
    border:none;
    margin-left:6px;
}

.viewer{
    position:absolute;
    inset:0;
    display:flex;
    justify-content:center;
    align-items:center;
}

canvas{
    box-shadow:0 0 40px rgba(0,0,0,0.9);
    max-height:95vh;
    transition:0.2s;
}

.arrow{
    position:absolute;
    top:50%;
    transform:translateY(-50%);
    font-size:38px;
    background:rgba(255,255,255,0.1);
    width:60px;
    height:60px;
    display:flex;
    justify-content:center;
    align-items:center;
    border-radius:50%;
    cursor:pointer;
}

.left{ left:40px; }
.right{ right:40px; }

.page-number{
    position:fixed;
    bottom:20px;
    right:25px;
    background:#111;
    padding:6px 14px;
    border-radius:15px;
}
</style>
</head>

<body>

<div class="topbar">
    <button class="btn" onclick="history.back()">← Geri</button>
    <div>
        <button class="btn" onclick="zoomOut()">−</button>
        <button class="btn" onclick="zoomIn()">+</button>
        <button class="btn" onclick="toggleFull()">Tam Ekran</button>
        <button class="btn" onclick="downloadPDF()">PDF İndir</button>
    </div>
</div>

<div class="viewer">
    <div class="arrow left" onclick="prevPage()">❮</div>
    <canvas id="pdf-render"></canvas>
    <div class="arrow right" onclick="nextPage()">❯</div>
</div>

<div class="page-number">
    <span id="page-num">0</span> / <span id="page-count">0</span>
</div>

<script>

const url = "dergi1/dergi1.pdf";

let pdfDoc = null;
let pageNum = 1;
let scale = 1.4;
let canvas = document.getElementById("pdf-render");
let ctx = canvas.getContext("2d");

pdfjsLib.getDocument(url).promise.then(pdf => {
    pdfDoc = pdf;
    document.getElementById("page-count").textContent = pdf.numPages;
    renderPage(pageNum);
});

function renderPage(num){
    pdfDoc.getPage(num).then(page=>{
        const viewport = page.getViewport({scale});
        canvas.height = viewport.height;
        canvas.width = viewport.width;

        ctx.clearRect(0,0,canvas.width,canvas.height);

        page.render({
            canvasContext: ctx,
            viewport: viewport
        });
    });

    document.getElementById("page-num").textContent = num;
}

function prevPage(){
    if(pageNum <= 1) return;
    pageNum--;
    renderPage(pageNum);
}

function nextPage(){
    if(pageNum >= pdfDoc.numPages) return;
    pageNum++;
    renderPage(pageNum);
}

function zoomIn(){
    scale += 0.2;
    renderPage(pageNum);
}

function zoomOut(){
    if(scale <= 0.6) return;
    scale -= 0.2;
    renderPage(pageNum);
}

/* Mouse wheel zoom */
canvas.addEventListener("wheel", e=>{
    e.preventDefault();
    if(e.deltaY < 0){
        zoomIn();
    } else {
        zoomOut();
    }
});

/* Tam ekran */
function toggleFull(){
    if(!document.fullscreenElement){
        document.documentElement.requestFullscreen();
    } else {
        document.exitFullscreen();
    }
}

/* Gerçek direkt indirme */
function downloadPDF(){
    const link = document.createElement("a");
    link.href = url;
    link.download = "dergi.pdf";
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
}

document.addEventListener("keydown", e=>{
    if(e.key==="ArrowRight") nextPage();
    if(e.key==="ArrowLeft") prevPage();
});

</script>

</body>
</html>
